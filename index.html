<!doctype html>
<html lang="de">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Low-Poly Fighting Game — Preview</title>
<style>
  html,body { height:100%; margin:0; font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; background:#0b1020; color:#e6eef8; }
  #canvas-holder { width:100%; height:100vh; display:block; position:relative; overflow:hidden; }
  #ui {
    position: absolute; left: 16px; top: 16px; z-index:10; max-width:360px;
    background: linear-gradient(180deg, rgba(7,10,20,0.8), rgba(7,10,20,0.6));
    padding:12px; border-radius:12px; box-shadow: 0 6px 24px rgba(0,0,0,0.6);
    backdrop-filter: blur(6px);
  }
  h1 { margin:0 0 8px 0; font-size:18px; color:#fff; }
  p { margin:6px 0 10px 0; font-size:13px; color:#cbd8ee; }
  .btn { display:inline-block; margin:6px 6px 6px 0; padding:8px 12px; border-radius:8px; background:#1976d2; color:white; text-decoration:none; font-weight:600; font-size:13px; }
  .btn.secondary { background:#4a4a4a; }
  .info { font-size:12px; color:#98a8d6; margin-top:6px; }
  #credits { position:absolute; right:16px; bottom:16px; color:#9fb0e6; font-size:12px; background: rgba(0,0,0,0.25); padding:8px 12px; border-radius:8px;}
  #legend { margin-top:8px; font-size:13px; }
  a.link { color:#9fe1ff; text-decoration:underline; }
  #overlay { position:absolute; left:0; top:0; right:0; bottom:0; display:none; align-items:center; justify-content:center; z-index:20; }
  #modal { background:#071024; padding:18px; border-radius:10px; width:380px; color:#dfefff; box-shadow:0 10px 40px rgba(0,0,0,0.6); }
  pre { background:rgba(255,255,255,0.02); padding:10px; border-radius:6px; overflow:auto; font-size:12px; }
</style>
</head>
<body>
<div id="canvas-holder"></div>

<div id="ui">
  <h1>Low-Poly Fighting Game — Web Preview</h1>
  <p>Interaktive 3D-Vorschau der Arena. Das ist <strong>keine</strong> echte Roblox-Instanz — sondern ein Browser-Preview der Map & Optik.</p>

  <a id="downloadBtn" class="btn" href="sandbox:/mnt/data/roblox_fighting_game_package.zip" download>Roblox-Paket herunterladen</a>
  <a id="openStudio" class="btn secondary">Wie teste ich in Roblox Studio?</a>

  <div id="legend">
    <strong>Legende:</strong>
    <ul style="margin:6px 0 0 18px; padding:0; color:#bcd0ff;">
      <li>Runde Arena — Plattform</li>
      <li>Weiße Segmente — low-poly Rim</li>
      <li>Schwarze Säulen — Deko/Pillars</li>
      <li>Gelber Punkt — Lobby / Teleporter</li>
    </ul>
  </div>

  <div class="info">Tipp: Zieh die Maus, um die Kamera zu drehen. Scroll zum Zoomen.</div>
</div>

<div id="credits">Preview & Export — Erstellt automatisch • Du</div>

<div id="overlay"><div id="modal">
  <h3>Roblox Studio testen — Kurz-Anleitung</h3>
  <p>1) Installiere <strong>Roblox Studio</strong> (kostenlos).<br>
  2) Öffne ein neues Baseplate-Projekt.<br>
  3) Öffne View → Command Bar. Füge den Inhalt von <code>PlaceBuilder.lua</code> ein und führe ihn aus.<br>
  4) Ersetze in StarterPack → Punch → Client_Punch die Stelle <code>rbxassetid://ANIMATION_ID</code> mit deiner Animation-ID.<br>
  5) Drücke Play (F5) — fertig.</p>
  <p class="info">Hosting-Tipp: Lade die erzeugten Dateien auf GitHub und aktiviere GitHub Pages oder nutze Netlify/Vercel.</p>
  <a id="closeModal" class="btn" href="#">Schließen</a>
</div></div>

<script type="module">
// Three.js via CDN (unpkg)
import * as THREE from 'https://unpkg.com/three@0.158.0/build/three.module.js';
import { OrbitControls } from 'https://unpkg.com/three@0.158.0/examples/jsm/controls/OrbitControls.js';

const container = document.getElementById('canvas-holder');
const scene = new THREE.Scene();
scene.background = new THREE.Color(0x071024);

// Camera
const camera = new THREE.PerspectiveCamera(50, window.innerWidth/window.innerHeight, 0.1, 1000);
camera.position.set(60, 40, 60);
camera.lookAt(0,0,0);

// Renderer
const renderer = new THREE.WebGLRenderer({antialias:true});
renderer.setPixelRatio(Math.min(window.devicePixelRatio, 2));
renderer.setSize(window.innerWidth, window.innerHeight);
container.appendChild(renderer.domElement);

// Lights
const hemi = new THREE.HemisphereLight(0xffffff, 0x444444, 0.8);
hemi.position.set(0, 200, 0);
scene.add(hemi);

const dir = new THREE.DirectionalLight(0xffffff, 0.8);
dir.position.set(50, 80, 25);
dir.castShadow = true;
scene.add(dir);

// Floor / base
const baseGeo = new THREE.CylinderGeometry(40, 40, 2, 24);
const baseMat = new THREE.MeshStandardMaterial({color:0xe67a2e, flatShading:true});
const base = new THREE.Mesh(baseGeo, baseMat);
base.position.y = 1;
scene.add(base);

// Rim segments (low-poly look)
const rimMat = new THREE.MeshStandardMaterial({color:0xffffff, flatShading:true});
for(let i=0;i<12;i++){
  const angle = i * (Math.PI*2/12);
  const segGeo = new THREE.BoxGeometry(7, 4, 10);
  const seg = new THREE.Mesh(segGeo, rimMat);
  const x = Math.cos(angle) * 42;
  const z = Math.sin(angle) * 42;
  seg.position.set(x, 3, z);
  seg.rotation.y = -angle;
  scene.add(seg);
}

// Pillars
const pillarGeo = new THREE.BoxGeometry(4,12,4);
const pillarMat = new THREE.MeshStandardMaterial({color:0x000000, flatShading:true});
for(let i=1;i<=6;i++){
  const ang = i * (Math.PI*2/6);
  const x = Math.cos(ang) * 20;
  const z = Math.sin(ang) * 20;
  const p = new THREE.Mesh(pillarGeo, pillarMat);
  p.position.set(x, 6, z);
  scene.add(p);
}

// Lobby Pad (yellow marker)
const lobbyGeo = new THREE.BoxGeometry(8,1,8);
const lobbyMat = new THREE.MeshStandardMaterial({color:0xffd54f, opacity:0.9, transparent:true, flatShading:true});
const lobbyPad = new THREE.Mesh(lobbyGeo, lobbyMat);
lobbyPad.position.set(-120,1,0);
scene.add(lobbyPad);

// Simple ground plane to give depth
const groundGeo = new THREE.PlaneGeometry(800,800,2,2);
const groundMat = new THREE.MeshStandardMaterial({color:0x0f1724, side:THREE.DoubleSide});
const ground = new THREE.Mesh(groundGeo, groundMat);
ground.rotation.x = -Math.PI/2;
ground.position.y = -1;
scene.add(ground);

// Simple "player" cubes to show scale & rotate
const playerMat = new THREE.MeshStandardMaterial({color:0x4caf50, flatShading:true});
const players = [];
for(let i=0;i<6;i++){
  const cube = new THREE.Mesh(new THREE.BoxGeometry(2.2,3,1.6), playerMat);
  const a = i * (Math.PI*2/6);
  cube.position.set(Math.cos(a)*10, 1.6, Math.sin(a)*10);
  scene.add(cube);
  players.push(cube);
}

// Helpers: grid & axes (optional)
// const grid = new THREE.GridHelper(200, 40, 0x333a4a, 0x11131a);
// scene.add(grid);

// Controls
const controls = new OrbitControls(camera, renderer.domElement);
controls.target.set(0,2,0);
controls.enableDamping = true;

// Resize handler
window.addEventListener('resize', ()=>{
  camera.aspect = window.innerWidth/window.innerHeight;
  camera.updateProjectionMatrix();
  renderer.setSize(window.innerWidth, window.innerHeight);
});

// Animation loop
const clock = new THREE.Clock();
function animate(){
  requestAnimationFrame(animate);
  const t = clock.getElapsedTime();
  // little idle movement for players
  players.forEach((p, idx)=> {
    p.rotation.y = Math.sin(t*1.2 + idx) * 0.12;
  });
  controls.update();
  renderer.render(scene, camera);
}
animate();

// UI interactions
document.getElementById('openStudio').addEventListener('click', ()=>{
  document.getElementById('overlay').style.display = 'flex';
});
document.getElementById('closeModal').addEventListener('click', (e)=>{
  e.preventDefault();
  document.getElementById('overlay').style.display = 'none';
});

// Try to make the download link open the sandbox path in the host (works in this environment)
const downloadBtn = document.getElementById('downloadBtn');
// If the sandbox path doesn't resolve when hosted, user should replace the href with their hosted zip URL.

</script>
</body>
</html>
